{"version":3,"sources":["../../../src/frontend/web3/index.ts"],"names":["Web3Provider","sendMessageAndAwaitResponse","kojiEventName","data","isConnected","args","result","event","callback","scopedEventName","registerMessageListener","KojiBridge","client","web3Provider"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;;;;;;;;AAqBA;AACA;AACA;IACaA,Y;;;;;;;;;;;;;AACX;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;uBAKc,KAAKC,2BAAL,CAAiC;AACzCC,kBAAAA,aAAa,EAAE,kCAD0B;AAEzCC,kBAAAA,IAAI,EAAE;AAFmC,iBAAjC,EAGP,+BAHO,C;;;;AADRC,gBAAAA,W,yBAAAA,W;iDAMKA,W;;;;;;;;;;;;;;;;AAGT;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;qHACuBC,I;;;;;;;uBACE,KAAKJ,2BAAL,CAAiC;AACpDC,kBAAAA,aAAa,EAAE,8BADqC;AAEpDC,kBAAAA,IAAI,EAAE;AACJE,oBAAAA,IAAI,EAAJA;AADI;AAF8C,iBAAjC,EAKlB,mCALkB,C;;;AAAfC,gBAAAA,M;kDAOCA,M;;;;;;;;;;;;;;;;AAGT;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;uBAEIC,K,EACAC,Q,EACM;AACN,UAAMC,eAAe,sCAA+BF,KAA/B,CAArB;AACA,WAAKG,uBAAL,CAA6BD,eAA7B,EAA8CD,QAA9C;AACD;;;EAjE+BG,sB,iFAW/BC,c;;AAyDI,IAAMC,YAAY,GAAG,IAAIb,YAAJ,EAArB","sourcesContent":["import { KojiBridge } from '../kojiBridge';\nimport { client } from '../@decorators/client';\n\n/**\n * A web3 request to proxy\n */\nexport interface Web3Request {\n  method: string;\n  params?: any[];\n}\n\n/**\n * Result of a proxied web3 request\n */\nexport interface Web3RequestResult {\n  result: unknown;\n  error?: {\n    code: number;\n    message: string;\n  };\n}\n\n/**\n * Manages authentication and authorization on the frontend of your Koji app.\n */\nexport class Web3Provider extends KojiBridge {\n  /**\n   * Gets whether or not the session is connect\n   *\n   * @return    Is connected\n   *\n   * @example\n   * ```javascript\n   * const isConnected = await Koji.web3.isConnected();\n   * ```\n   */\n  @client\n  public async isConnected(): Promise<boolean> {\n    const {\n      isConnected,\n    } = await this.sendMessageAndAwaitResponse({\n      kojiEventName: '@@koji/web3/ethereum/isConnected',\n      data: {},\n    }, 'KojiWeb3.Ethereum.IsConnected');\n\n    return isConnected;\n  }\n\n  /**\n   * Proxies a request to an Ethereum wallet provider.\n   *\n   * @param   request       The request to proxy\n   * @return                Request result\n   *\n   * @example\n   * ```javascript\n   * const accounts = await Koji.web3.request({ method: 'eth_requestAccounts' });\n   * ```\n   */\n  public async request(args: Web3Request): Promise<Web3RequestResult> {\n    const result = await this.sendMessageAndAwaitResponse({\n      kojiEventName: '@@koji/web3/ethereum/request',\n      data: {\n        args,\n      },\n    }, 'KojiWeb3.Ethereum.RequestFinished');\n\n    return result;\n  }\n\n  /**\n   * Register an event listener for wallet events\n   *\n   * @param   event             The name of the event for which to listen.\n   * @param   callback          Called when the event is received\n   *\n   *\n   * @example\n   * ```javascript\n   * Koji.web3.on('accountsChanged', ({ accounts }) => {\n   *   console.log(accounts);\n   * })\n   * ```\n   */\n  public on(\n    event: 'accountsChanged'|'chainChanged'|'connect'|'disconnect'|'message',\n    callback: (message: any) => void,\n  ): void {\n    const scopedEventName = `KojiWeb3.Ethereum.Events.${event}`;\n    this.registerMessageListener(scopedEventName, callback);\n  }\n}\n\nexport const web3Provider = new Web3Provider();\n"],"file":"index.js"}